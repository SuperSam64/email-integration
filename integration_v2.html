<html>
  <head>
    <title>V2</title>
    <link href="style.css" rel="stylesheet">
    <link href="https://integrations.missiveapp.com/missive.css" rel="stylesheet">
    <script src="https://integrations.missiveapp.com/missive.js"></script>
    <script src="script.js"></script>
  </head>
  <body style="width:92%;height:96%;margin:auto">
    <div class="column-vertical column-center margin section align-center" style="margin-top:8px;margin-bottom:8px">
			<!---------------------------  [[  VERSION  ]]  ------------------------------>
			<span class="button-link column padding" id="reload-button">Version 2.51</span>
			<!---------------------------------------------------------------------------->
		</div>
    <!-------------------------- BUTTON -------------------------------------->
    <span class="button column padding testButton" id="button1">Click me</span>
    <!------------------------------------------------------------------------>

    <table>
      <tr id="title1" class="textTitle"><td width="24 px" style="text-align:right">1.</td><td></td><td>
        Conversation ID
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body1" class="textBody">
        Here is some text
      </td></tr>
    </table>



    <!------------------------- TEXT BOX -------------------------->
    <table>
      <tr id="title1" class="textTitle"><td width="24 px" style="text-align:right">
      
      </td><td></td><td>
        
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body1" class="textBody">

      </td></tr>
    </table>
    <!------------------------------------------------------------->
    
    
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical section">
      <div id="title1">
        <div class="textTitle topSection">
          <table>
            1. Conversation ID
          </table>
        </div>
        <div id="body1" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title2">
        <div class="textTitle">
          2. Conversation Count
        </div>
        <div id="body2" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title3">
        <div class="textTitle">
          3. To
        </div>
        <div id="body3" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title4">
        <div class="textTitle">
          4. From
        </div>
        <div id="body4" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title5">
        <div class="textTitle">
          5. Customer's name
        </div>
        <div id="body5" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title6">
        <div class="textTitle">
          6. Message subject
        </div>
        <div id="body6" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title7">
        <div class="textTitle">
          7. Conversation subject
        </div>
        <div id="body7" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title8">
        <div class="textTitle">
          8. Is this assigned to me?
        </div>
        <div id="body8" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title9">
        <div class="textTitle">
          9. Is this a draft that needs to be assigned?
        </div>
        <div id="body9" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title10">
        <div class="textTitle">
          10. Does the email address need to be replaced?
        </div>
        <div id="body10" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title11">
        <div class="textTitle">
          11. Link to conversation
        </div>
        <div id="body11" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title12">
        <div class="textTitle">
          12. Link to message
        </div>
        <div id="body12" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title13">
        <div class="textTitle">
          13. All labels
        </div>
        <div id="body13" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical">
      <div id="title14">
        <div class="textTitle">
          14. Is the label "Cancellations" applied? (1d53229eb9e1)
        </div>
        <div id="body14" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <div class="textFrame column-vertical">
      <div id="title15">
        <div class="textTitle">
          15. Preview
        </div>
        <div id="body15" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <div class="textFrame column-vertical">
      <div id="title16">
        <div class="textTitle">
          16. Full Message
        </div>
        <div id="body16" class="textBody bottomSection">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script type="text/javascript">
      //---- VARIABLES ----
      var currentUser;
			var fullName;
			var profileType = "CCA"; // CCA, CRM, master
			var title = "Customer Care Advocate" // default, unless  otherwise specified
      var crmList = ["fd1f7da207de","a50d68b28cfd","cc4c53720ddf","37e9dbc091a3","f77b171dc34c"]; // (Gema, Isabel, Kaitlyn, Kylee, Alli)
			var adminList = ["dfbf5285907d","eebc81b9f454","aaa5d13aaeb2"] // (Sam, David, Amelia)
      var currentConversation;
      var conversationID;
      var conversationCount;
      var messageTo;
      var messageFrom;
      var customerName;
      var messageSubject;
      var conversationSubject;
      var userAssigned;
      var assignDraft;
      var forwarded;
      var conversationLink;
      var messageLink;
      var labels;
      var isLabeled;
      var preview;
      var fullMessage
      // ============ PAGE LOAD ==============
      $(document).ready((ids) => {
        Missive.fetchUsers().then((users) => {
          $(users).each(function(){
            if(this.me){
                currentUser = this;
            }
          });
          $(adminList).each(function(){
            if(this == currentUser.id.split("-")[4]){
              profileType = "master"
              title = "Administrator";
            }
          });
          $(crmList).each(function(){
            if(this == currentUser.id.split("-")[4]){
              profileType = "CRM"
              title = "Client Relationship Manager";
            }
          });
        //var fullName = currentUser.first_name + " " + currentUser.last_name;
        //$("#avatar").css("background-image","url(" + currentUser.avatar_url + ")");
        //$("#name").text(fullName);
        //$("#layout").text(title);
        });				
      });
      // =====================================
      //------- WHEN CONVERSATION CHANGES ---------
      Missive.on('change:conversations', (ids) => {
				Missive.fetchConversations(ids).then((conversations) => {		
					currentConversation = conversations[0];
          conversationID = getConversation(currentConversation);
          conversationCount = getMessageCount(currentConversation);
          messageTo = getTo(currentConversation);
          messageFrom = getFrom(currentConversation);
          customerName = getName(currentConversation);
          messageSubject = getMessageSubject(currentConversation);
          conversationSubject = getConversationSubject(currentConversation);
          userAssigned = checkAssigned(currentConversation);
          assignDraft = checkDraft(currentConversation);
          forwarded = updateFrom(currentConversation);
          conversationLink = getConversationLink(currentConversation);
          messageLink = getMessageLink(currentConversation);
          labels = getLabels(currentConversation);
          isLabeled = labelCheck(currentConversation, "1d53229eb9e1"); // shorten this later
          preview = getPreview(currentConversation);
          fullMessage = getFullMessage(currentConversation);
          showResults();
				})
			})
      //---------------- RESETS ------------------
      $("#title1").click(function () { 
        body1Reset();
      });
      $("#body1").click(function () { 
        body1Reset();
      });
      $("#title2").click(function () { 
        body2Reset();
      });
      $("#body2").click(function () { 
        body2Reset();
      });
      $("#title3").click(function () { 
        body3Reset();
      });
      $("#body3").click(function () { 
        body3Reset();
      });
      $("#title4").click(function () { 
        body4Reset();
      });
      $("#body4").click(function () { 
        body4Reset();
      });
      $("#title5").click(function () { 
        body5Reset();
      });
      $("#body5").click(function () { 
        body5Reset();
      });
      $("#title6").click(function () { 
        body6Reset();
      });
      $("#body6").click(function () { 
        body6Reset();
      });
      $("#title7").click(function () { 
        body7Reset();
      });
      $("#body7").click(function () { 
        body7Reset();
      });
      $("#title8").click(function () { 
        body8Reset();
      });
      $("#body8").click(function () { 
        body8Reset();
      });
      $("#title9").click(function () { 
        body9Reset();
      });
      $("#body9").click(function () { 
        body9Reset();
      });
      $("#title10").click(function () { 
        body10Reset();
      });
      $("#body10").click(function () { 
        body10Reset();
      });
      $("#title11").click(function () { 
        body11Reset();
      });
      $("#body11").click(function () { 
        body11Reset();
      });
      $("#title12").click(function () { 
        body12Reset();
      });
      $("#body12").click(function () { 
        body12Reset();
      });
      $("#title13").click(function () { 
        body13Reset();
      });
      $("#body13").click(function () { 
        body13Reset();
      });
      $("#title14").click(function () { 
        body14Reset();
      });
      $("#body14").click(function () { 
        body14Reset();
      });
      $("#body15").click(function () { 
        body15Reset();
      });
      $("#body16").click(function () { 
        body16Reset();
      });
      $("#button1").click(function () { 
        getConversation();
      });
    </script>
</body>
</html>

<html>
  <head>
    <title>V2</title>
    <link href="style.css" rel="stylesheet">
    <link href="https://integrations.missiveapp.com/missive.css" rel="stylesheet">
    <script src="https://integrations.missiveapp.com/missive.js"></script>
    <script src="script.js"></script>
  </head>
  <body style="width:92%;height:96%;margin:auto">
    <div class="column-vertical column-center margin section align-center" style="margin-top:8px;margin-bottom:8px">
			<!---------------------------  [[  VERSION  ]]  ------------------------------>
			<span class="button-link column padding" id="reload-button">Version 1.82</span>
			<!---------------------------------------------------------------------------->
      <!--
        - get current convo
        - get previous convo
        - get current message
        - get replied status
        - get labels
        - get current message sender
        - get current message to
        - determine if there is a draft?
        - get current convo message count
        - get current convo subject
        - get current message subject
        - determine if last message was sent or received
        - check for spefic label  checklabel(label)
        - has attachments?
        - check for contact
        - swap emails
        - assign drafts
        - function to do all starting operations
        - create task
        - show form
        - link within extension
        - link to other extension
        - link outside of extension
        - assign label
      -->
		</div>
    <!-------------------------- BUTTON -------------------------------------->
    <span class="button column padding testButton" id="button1">Click me</span>
    <!------------------------------------------------------------------------>
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical section"><div id="title1">
        <div class="textTitle">
          Conversation ID
        </div>
        <div id="body1" class="textBody">
          Here is some text
        </div>
      </div>
    </div>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <div class="textFrame column-vertical"><div id="title2">
      <div class="textTitle">
        Conversation Count
      </div>
      <div id="body2" class="textBody">
        Here is some text
      </div>
    </div>
  </div>
  <!------------------------------------------------------------->
  <!------------------------- TEXT BOX -------------------------->
  <div class="textFrame column-vertical"><div id="title3">
    <div class="textTitle">
      To
    </div>
    <div id="body3" class="textBody">
      Here is some text
    </div>
  </div>
</div>
<!------------------------------------------------------------->
<!------------------------- TEXT BOX -------------------------->
<div class="textFrame column-vertical"><div id="title4">
  <div class="textTitle">
    From
  </div>
  <div id="body4" class="textBody">
    Here is some text
  </div>
</div>
</div>
<!------------------------------------------------------------->
<!------------------------- TEXT BOX -------------------------->
<div class="textFrame column-vertical"><div id="title5">
  <div class="textTitle">
    Message subject
  </div>
  <div id="body5" class="textBody">
    Here is some text
  </div>
</div>
</div>
<!------------------------------------------------------------->
<!------------------------- TEXT BOX -------------------------->
<div class="textFrame column-vertical"><div id="title6">
  <div class="textTitle">
    Conversation subject
  </div>
  <div id="body6" class="textBody">
    Here is some text
  </div>
</div>
</div>
<!------------------------------------------------------------->
<!------------------------- TEXT BOX -------------------------->
<div class="textFrame column-vertical"><div id="title7">
  <div class="textTitle">
    Is this assigned to me?
  </div>
  <div id="body7" class="textBody">
    Here is some text
  </div>
</div>
</div>
<!------------------------------------------------------------->
<!------------------------- TEXT BOX -------------------------->
<div class="textFrame column-vertical"><div id="title8">
  <div class="textTitle">
    Is this a draft that needs to be assigned?
  </div>
  <div id="body8" class="textBody">
    Here is some text
  </div>
</div>
</div>
<!------------------------------------------------------------->
<!------------------------- TEXT BOX -------------------------->
<div class="textFrame column-vertical"><div id="title9">
  <div class="textTitle">
    "To" and "From" both end in "@filtersfast.com"
  </div>
  <div id="body9" class="textBody">
    Here is some text
  </div>
</div>
</div>
<!------------------------------------------------------------->
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script type="text/javascript">
      //---- VARIABLES ----
      var currentUser;
			var fullName;
			var profileType = "CCA"; // CCA, CRM, master
			var title = "Customer Care Advocate" // default, unless  otherwise specified
      var crmList = ["fd1f7da207de","a50d68b28cfd","cc4c53720ddf","37e9dbc091a3","f77b171dc34c"]; // (Gema, Isabel, Kaitlyn, Kylee, Alli)
			var adminList = ["dfbf5285907d","eebc81b9f454","aaa5d13aaeb2"] // (Sam, David, Amelia)
      var currentConversation;
      var currentMessage;
      var var1;
      var var2;
      var var3;
      var var4;
      var var5;
      var var6;
      var var7;
      var var8;
      var var9;
      // ============ PAGE LOAD ==============
      $(document).ready((ids) => {
        Missive.fetchUsers().then((users) => {
          $(users).each(function(){
            if(this.me){
                currentUser = this;
            }
          });
          $(adminList).each(function(){
            if(this == currentUser.id.split("-")[4]){
              profileType = "master"
              title = "Administrator";
            }
          });
          $(crmList).each(function(){
            if(this == currentUser.id.split("-")[4]){
              profileType = "CRM"
              title = "Client Relationship Manager";
            }
          });
        //var fullName = currentUser.first_name + " " + currentUser.last_name;
        //$("#avatar").css("background-image","url(" + currentUser.avatar_url + ")");
        //$("#name").text(fullName);
        //$("#layout").text(title);
        });				
      });
      // =====================================
      // "5c21049b-5a49-476c-813e-dfbf5285907d";  // CHANGE THIS LATER
      //-------------------
      //------- WHEN CONVERSATION CHANGES ---------
      Missive.on('change:conversations', (ids) => {
				Missive.fetchConversations(ids).then((conversations) => {		
					currentConversation = conversations[0];
          var1 = body1Click(currentConversation);
          var2 = body2Click(currentConversation);
          var3 = body3Click(currentConversation);
          var4 = body4Click(currentConversation);
          var5 = body5Click(currentConversation);
          var6 = body6Click(currentConversation);
          var7 = body7Click(currentConversation);
          var8 = body8Click(currentConversation);
          var9 = body9Click(currentConversation);
          $("#body1").text(var1);
          $("#body2").text(var2);
          $("#body3").text(var3);
          $("#body4").text(var4);
          $("#body5").text(var5);
          $("#body6").text(var6); // + " | " + currentConversation.something);
          $("#body7").text(var7);
          $("#body8").text(var8);
          $("#body9").text(var9);
				})
			})
      //------- WHEN CONVERSATION CHANGES ---------
      $("#title1").click(function () { 
        body1Reset();
      });
      $("#body1").click(function () { 
        body1Reset();
      });
      $("#title2").click(function () { 
        body2Reset();
      });
      $("#body2").click(function () { 
        body2Reset();
      });
      $("#title3").click(function () { 
        body3Reset();
      });
      $("#body3").click(function () { 
        body3Reset();
      });
      $("#title4").click(function () { 
        body4Reset();
      });
      $("#body4").click(function () { 
        body4Reset();
      });
      $("#title5").click(function () { 
        body5Reset();
      });
      $("#body5").click(function () { 
        body5Reset();
      });
      $("#title6").click(function () { 
        body6Reset();
      });
      $("#body6").click(function () { 
        body6Reset();
      });
      $("#title7").click(function () { 
        body7Reset();
      });
      $("#body7").click(function () { 
        body7Reset();
      });
      $("#title8").click(function () { 
        body8Reset();
      });
      $("#body8").click(function () { 
        body8Reset();
      });
      $("#title9").click(function () { 
        body9Reset();
      });
      $("#body9").click(function () { 
        body9Reset();
      });
      $("#button1").click(function () { 
        body1Click();
      });
      $("#button2").click(function () { 
        body2Click();
      });
      $("#button3").click(function () { 
        body3Click();
      });
      $("#button4").click(function () { 
        body4Click();
      });
      $("#button5").click(function () { 
        body5Click();
      });
      $("#button6").click(function () { 
        body6Click();
      });
      $("#button7").click(function () { 
        body7Click();
      });
      $("#button8").click(function () { 
        body8Click();
      });
      $("#button9").click(function () { 
        body9Click();
      });
    </script>
</body>
</html>

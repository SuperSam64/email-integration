<html>
  <head>
    <title>V2</title>
    <link rel="stylesheet" href="form.css">
    <link href="https://integrations.missiveapp.com/missive.css" rel="stylesheet">
    <link id="access-level" href="access_level_cca.css" rel="stylesheet">
    <link rel="stylesheet" href="contact-display.css">
    <link rel="stylesheet" href="monday.css">
    <link href="style.css" rel="stylesheet">
    <script src="https://integrations.missiveapp.com/missive.js"></script>
    <script type="text/javascript" src="monday_colors.js"></script>
    <script type="text/javascript" src="monday_search.js"></script>
    <script type="text/javascript" src="contact-display.js"></script>
    <script src="script.js"></script>
  </head>
  <body style="width:92%;height:96%;margin:auto;overflow:hidden">
    <div style="position:fixed;top:0px;left:0px;margin:0px;padding:0px;z-index:1;width:100%;background-color:var(--missive-background-color)">
      <div id="topBanner" class="column-vertical padding margin section" style="border:1px solid var(--missive-conversation-list-border-color);border-radius:6px;background-color: var(--missive-conversation-list-background-color)">
    <!------------------------------- HEADER ---------------------------------><span>
      <table cellspacing="0" cellpadding="0" style="margin:auto;border:none">
        <tbody>
          <tr>
            <td rowspan="2">
              <span id="avatar" style="border:4px solid var(--accent-color);display:block;background-image: url('profileplaceholder.png');height:54px;width:54px;background-size:cover;background-position: center center;border-radius:32px"></span>
            </td>
            <td>
              <span id="name" style="margin-left:8px" class="text-xlarge text-600"></span>
            </td>
          </tr>
          <tr>
            <td>
              <span id="layout" style="margin-left:8px;vertical-align:top;font-style: italic" class="text-small text-c"></span>
            </td>
          </tr>
        </tbody>
      </table>
    <!------------------------------------------------------------------------></span>
    <!---------------------------- [[  RELOAD  ]] ----------------------------></div><div id="version_number" class="button-link margin section align-center" style="margin:auto;width:100%;padding-bottom:12px">
    <!--------------------->     Reload Integration    <!--------------------->
    <!------------------------------------------------------------------------></div></div>
    <div style="margin-top:160px;margin-bottom:12px">
      <div>
        <span id="textmod">
        </span>
        <div id="contactEdit" class="panel hidden">
          <form id="contactForm" action="/action_page.php">
            <table class="form">
              <tbody>
                <tr>
                  <th colspan="6">
                    Edit Customer Information
                  </th>
                </tr>
                <tr>
                  <td colspan="2" class="left middle caption">
                    <label for="firstname">
                      First Name
                    </label>
                  </td>
                  <td colspan="2" class="middle caption">
                    <label for="lastname">
                      Last Name
                    </label>
                  </td>
                    <td colspan="2" class="right middle caption">
                    <label for="custID">
                      CID
                    </label>
                  </td>
                </tr>
                <tr>
                  <td colspan="2" class="left middle input">
                    <input type="text" id="formFirstName" name="formFirstName" style="text-transform:capitalize" value="Sam">
                  </td>
                  <td colspan="2" class="middle input">
                    <input type="text" id="formLastName" name="formLastName" style="text-transform:capitalize" value="Nimmo">
                  </td>
                    <td colspan="2" class="right middle input">
                    <input type="text" id="formCustID" name="formCustID" value="7654321">
                  </td>
                </tr>
                <tr>
                  <td colspan="3" class="left middle caption">
                    <label for="phonenum">
                      Phone Number
                    </label>
                  </td>
                  <td colspan="3" class="right middle caption">
                    <label for="email">
                      Email
                    </label>
                  </td>
                </tr>
                <tr>
                  <td colspan="3" class="left middle input">
                    <input type="text" id="formPhoneNumber" name="phonenum" value="(704) 555-5555">
                  </td>
                  <td colspan="3" class="right middle input">
                    <input type="text" id="formEmail" name="email" value="sampson@filtersfast.com">
                  </td>
                </tr>
              </tbody>
            </table>
          <div style="border-top:1px solid var(--missive-light-border-color)">
            <table class="form">
              <tbody>
                <tr>
                  <td colspan="2" class="left right caption">
                    <label for="orderNumbers">
                      Order Numbers (separated by commas)
                    </label>
                  </td>
                </tr>
                <tr>
                  <td colspan="2" class="left right input">
                    <input type="text" id="formOrderNumbers" name="orderNumbers" value="12345678">
                  </td>
                </tr>
                <tr>
                  <td class="bottom left">
                    <input class="button" style="margin-top:12px;width:100%" type="button" value="Save Contact" onclick="contactFormSave()">
                  </td>
                  <td class="bottom right ">
                    <input class="button" style="margin-top:12px;width:100%;background-color:var(--missive-orange-color)" type="button" value="Cancel" onclick="contactFormCancel()">
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </form>
      </div>
      <div id="contactInfoSection" class="panel">
        <table class="form">
          <th colspan="2">
            Customer Information
          </th>
          <tr>
            <td class="left middle">
              <span class="fieldText" id="nameField" onclick="copyToClipboard('name',animationLength)">
              </span>
            </td>
            <td class="right middle">
              <span class="fieldText" id="CIDField" onclick="copyToClipboard('CID',animationLength)">
              </span>
            </td>
          </tr>
          <tr>
            <td class="left right">
              <span class="fieldText" id="phoneField" onclick="copyToClipboard('phone',animationLength)">
              </span>
            </td>
            <td class="left right">
              <span class="fieldText" id="emailField" onclick="copyToClipboard('email',animationLength)">
              </span>
            </td>
          </tr>
        </table>
        <div id="ordersSection" style="border-top:1px solid var(--missive-light-border-color)">
          <table class="form">
            <tbody>
              <tr>
                <td class="left right" id="orderNumberList"></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div id="add-edit">
          <span class="button-token" onclick="showEditPanel()">
            EDIT
          </span>		
        </div>
      </div>
    </div>
    <!------------------------------- BUTTONS --------------------------------><span>
    <div id="mondaySection" style="margin-top:12px;border:1px solid var(--missive-conversation-list-border-color);border-radius:6px;background-color:var(--missive-conversation-list-background-color)"><div class="loading" style="text-align:center;font-style:italic">LOADING...</div></div>
    <!---------------------------- HIDDEN BUTTONS ---------------------------->
    <span class="hiddenButton">
    <span class="button column padding testButton" style="margin-top:12px" id="button1">Cancellation (Reply)</span><br>
    <span class="button column padding testButton" id="button2">Cancellation (New thread)</span><br>
    <span class="button column padding testButton" id="button3">Insert Signature</span><br>
    <span class="button column padding testButton" id="button4">Insert Tasks</span><br>
    <span class="button column padding testButton" id="button5">Insert Reply Draft</span><br>
    <span class="button column padding testButton" id="button6">Save Contact</span><br>
    <span class="button column padding testButton" id="button7">[button label]</span><br>
    <span class="button column padding testButton" id="button8">[button label]</span><br>
    <span class="button column padding testButton" id="button9">[button label]</span><br>
    <span class="button column padding testButton" id="button10">[button label]</span><br>
    <span class="button column padding testButton" id="button11">[button label]</span><br>
    <span class="button column padding testButton" id="button12">[button label]</span><br>
    <span class="button column padding testButton" id="button13">[button label]</span><br>
    <span class="button column padding testButton" id="button14">[button label]</span><br>
    <span class="button column padding testButton" id="button15">[button label]</span><br>
    <span class="button column padding testButton" id="button16">[button label]</span><br>
    <span class="button column padding testButton" id="button17">[button label]</span><br>
    <span class="button column padding testButton" id="button18">[button label]</span><br>
    <span class="button column padding testButton" id="button19">[button label]</span><br>
    <span class="button column padding testButton" id="button20">[button label]</span><br>
    </span></span>
    <!------------------------------------------------------------------------></span>
    <!--------------------------- TABLE OF RESULTS ---------------------------><table style="display:none" class="textFrame" id="textFrame">
    <!------------------------- TEXT BOX -------------------------->
    <tr id="title1" class="textTitle"><td width="24 px" style="text-align:right">
      1.
    </td><td></td><td>
      Conversation ID
    </td></tr><tr><td colspan="2"></td><td colspan="3" id="body1" class="textBody">
      [placeholder]
    </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title2" class="textTitle"><td width="24 px" style="text-align:right">
        2.
      </td><td></td><td>
        Conversation Count
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body2" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title3" class="textTitle"><td width="24 px" style="text-align:right">
        3.
      </td><td></td><td>
        To
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body3" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title4" class="textTitle"><td width="24 px" style="text-align:right">
        4.
      </td><td></td><td>
        From
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body4" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title5" class="textTitle"><td width="24 px" style="text-align:right">
        5.
      </td><td></td><td>
        Customer's Name
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body5" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title6" class="textTitle"><td width="24 px" style="text-align:right">
        6.
      </td><td></td><td>
        Message Subject
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body6" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title7" class="textTitle"><td width="24 px" style="text-align:right">
        7.
      </td><td></td><td>
        Conversation Subject
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body7" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title8" class="textTitle"><td width="24 px" style="text-align:right">
        8.
      </td><td></td><td>
        Is this assigned to me?
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body8" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title9" class="textTitle"><td width="24 px" style="text-align:right">
        9.
      </td><td></td><td>
        Is this a draft that needs to be assigned?
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body9" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title10" class="textTitle"><td width="24 px" style="text-align:right">
        10.
      </td><td></td><td>
        Does the email address need to be replaced?
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body10" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title11" class="textTitle"><td width="24 px" style="text-align:right">
        11.
      </td><td></td><td>
        Link to Conversation
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body11" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title12" class="textTitle"><td width="24 px" style="text-align:right">
        12.
      </td><td></td><td>
        Link to Message
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body12" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title13" class="textTitle"><td width="24 px" style="text-align:right">
        13.
      </td><td></td><td>
        All Labels
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body13" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title14" class="textTitle"><td width="24 px" style="text-align:right">
        14.
      </td><td></td><td>
        Is the label "Cancellations" applied? (1d53229eb9e1)
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body14" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title15" class="textTitle"><td width="24 px" style="text-align:right">
        15.
      </td><td></td><td>
        Preview
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body15" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title16" class="textTitle"><td width="24 px" style="text-align:right">
        16.
      </td><td></td><td>
        Full Message
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body16" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
      <tr id="title17" class="textTitle"><td width="24 px" style="text-align:right">
        17.
      </td><td></td><td>
        Order Number
      </td></tr><tr><td colspan="2"></td><td colspan="3" id="body17" class="textBody">
        [placeholder]
      </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <tr id="title18" class="textTitle"><td width="24 px" style="text-align:right">
      18.
    </td><td></td><td>
      Time Stamp
    </td></tr><tr><td colspan="2"></td><td colspan="3" id="body18" class="textBody bottomSection">
      [placeholder]
    </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <tr id="title19" class="textTitle"><td width="24 px" style="text-align:right">
      19.
    </td><td></td><td>
      Token
    </td></tr><tr><td colspan="2"></td><td colspan="3" id="body19" class="textBody bottomSection">
      [placeholder]
    </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <tr id="title20" class="textTitle"><td width="24 px" style="text-align:right">
      20.
    </td><td></td><td>
      [placeholder]
    </td></tr><tr><td colspan="2"></td><td colspan="3" id="body20" class="textBody bottomSection">
      [placeholder]
    </td></tr>
    <!------------------------------------------------------------->
    <!------------------------- TEXT BOX -------------------------->
    <tr id="title21" class="textTitle"><td width="24 px" style="text-align:right">
      21.
    </td><td></td><td>
      Greeting
    </td></tr><tr><td colspan="2"></td><td colspan="3" id="body21" class="textBody bottomSection">
      [placeholder]
    </td></tr>
    <!------------------------------------------------------------->
    <!------------------------------------------------------------------------></table>
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script type="text/javascript">
    {//----------------------------- VARIABLES --------------------------------
      var baseVersion = "11";
      var revisionNumber = "80";
      var scriptVersion = "302";
      var version = "Version " + baseVersion + "." + revisionNumber + "." + scriptVersion; // Base version > revision number > script version
      console.log(version)
      var theme = "light";
      var initialized = false;
      var conversationActive; // bool, use this to determine if a screen needs to be shown asking the user to select a conversation
      var token;
      var organization;
      var contactBook;
      var currentUser;
      var userFullName;
      var profileType = "Customer Care Advocate"; // CCA, CRM, master
      var crmList = ["fd1f7da207de","a50d68b28cfd","cc4c53720ddf","37e9dbc091a3","f77b171dc34c"]; // (Gema, Isabel, Kaitlyn, Kylee, Alli)
      var adminList = ["dfbf5285907d","eebc81b9f454","aaa5d13aaeb2"] // (Sam, David, Amelia)
      var currentConversation;
      var conversationID;
      var conversationCount;
      //var messageTo;
      var messageFrom;
      var customerName;
      var messageSubject;
      var conversationSubject;
      var userAssigned;
      var assignDraft;
      //var forwarded;
      var replied;
      var conversationLink;
      var messageLink;
      var labels;
      var isLabeled;
      //var preview;
      var fullMessage;
      var orderNumber;
      var greeting;
      var intro;
      var signature;
      var emailClosing = "Sincerely";
      var suggestedLabel;
      // var timeStamp;
      var contact = {};
      var purchaseOrderTasks = [
        "Email customer for PO revision",
        "PO prepared",
        "Customer is on terms (Limit: $)",
        "- or - Email customer that order needs payment",
        "Take payment",
        "Send confirmation email",
        "Sending shippng info to [DC](https://filtersfast.monday.com/boards/768866444) | [Purchasing](https://filtersfast.monday.com/boards/768866444)"
      ]
    }
    //-------------------------------------------------------------------------
    // ----------------------------- PAGE LOAD --------------------------------
    $(window).on('load',(ids) => {
      startup();
    });
    // ------------------------------------------------------------------------
    //---------------------- WHEN CONVERSATION CHANGES ------------------------
    Missive.on('change:conversations', (ids) => {
      convoChange();  
      if(initialized == true){
          resetContactInfo();
          Missive.fetchConversations(ids).then((conversations) => {		
          currentConversation = conversations[0];
          storeLastConversation(conversations[0]);
          update(currentConversation);
          showResults();
          console.log("on change" + currentConversation.id)
        })
      }
    })
    //-------------------------------------------------------------------------
    {//----------------------------- RESETS -----------------------------------
    $("#title1").click(function () { 
      body1Reset();
    });
    $("#body1").click(function () { 
      body1Reset();
    });
    $("#title2").click(function () { 
      body2Reset();
    });
    $("#body2").click(function () { 
      body2Reset();
    });
    $("#title3").click(function () { 
      body3Reset();
    });
    $("#body3").click(function () { 
      body3Reset();
    });
    $("#title4").click(function () { 
      body4Reset();
    });
    $("#body4").click(function () { 
      body4Reset();
    });
    $("#title5").click(function () { 
      body5Reset();
    });
    $("#body5").click(function () { 
      body5Reset();
    });
    $("#title6").click(function () { 
      body6Reset();
    });
    $("#body6").click(function () { 
      body6Reset();
    });
    $("#title7").click(function () { 
      body7Reset();
    });
    $("#body7").click(function () { 
      body7Reset();
    });
    $("#title8").click(function () { 
      body8Reset();
    });
    $("#body8").click(function () { 
      body8Reset();
    });
    $("#title9").click(function () { 
      body9Reset();
    });
    $("#body9").click(function () { 
      body9Reset();
    });
    $("#title10").click(function () { 
      body10Reset();
    });
    $("#body10").click(function () { 
      body10Reset();
    });
    $("#title11").click(function () { 
      body11Reset();
    });
    $("#body11").click(function () { 
      body11Reset();
    });
    $("#title12").click(function () { 
      body12Reset();
    });
    $("#body12").click(function () { 
      body12Reset();
    });
    $("#title13").click(function () { 
      body13Reset();
    });
    $("#body13").click(function () { 
      body13Reset();
    });
    $("#title14").click(function () { 
      body14Reset();
    });
    $("#body14").click(function () { 
      body14Reset();
    });
    $("#body15").click(function () { 
      body15Reset();
    });
    $("#body16").click(function () { 
      body16Reset();
    });
    $("#body17").click(function () { 
      body17Reset();
    });
    $("#body18").click(function () { 
      body18Reset();
    });
    $("#body19").click(function () { 
      body19Reset();
    });
    $("#body20").click(function () { 
      body20Reset();
    });
    $("#body21").click(function () { 
      body21Reset();
    });
    $("#button1").click(function () { 
      button1Clicked();
    });
    $("#button2").click(function () { 
      button2Clicked();
    });
    $("#button3").click(function () { 
      button3Clicked();
    });
    $("#button4").click(function () { 
      button4Clicked();
    });
    $("#button5").click(function () { 
      button5Clicked();
    });
    $("#button6").click(function () { 
      button6Clicked();
    });
    $("#version_number").click(function (){
      Missive.reload();
    });
    }
    //-------------------------------------------------------------------------
    </script>
</body>
</html>